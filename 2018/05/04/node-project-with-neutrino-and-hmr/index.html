<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Why?For frontend apps based on React/new-foo-framework-of-month, we are used to HMR its make development easier. On another hand, we still use nodaemon or manual restart for backend app. This solution">
<meta name="keywords" content="node,neutrino,HMR">
<meta property="og:type" content="article">
<meta property="og:title" content="Node.js project with neutrino and hmr">
<meta property="og:url" content="https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/index.html">
<meta property="og:site_name" content="DysFunctional Programmer">
<meta property="og:description" content="Why?For frontend apps based on React/new-foo-framework-of-month, we are used to HMR its make development easier. On another hand, we still use nodaemon or manual restart for backend app. This solution">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-05-04T20:47:33.839Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Node.js project with neutrino and hmr">
<meta name="twitter:description" content="Why?For frontend apps based on React/new-foo-framework-of-month, we are used to HMR its make development easier. On another hand, we still use nodaemon or manual restart for backend app. This solution">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Node.js project with neutrino and hmr</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/beetleman">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2017/11/26/hello-world/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&text=Node.js project with neutrino and hmr"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&is_video=false&description=Node.js project with neutrino and hmr"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Node.js project with neutrino and hmr&body=Check out this article: https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&name=Node.js project with neutrino and hmr&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Why"><span class="toc-number">1.</span> <span class="toc-text">Why?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Solution"><span class="toc-number">2.</span> <span class="toc-text">Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#create-project"><span class="toc-number">2.1.</span> <span class="toc-text">create project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setup-docker"><span class="toc-number">2.2.</span> <span class="toc-text">setup docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#run-tests"><span class="toc-number">2.3.</span> <span class="toc-text">run tests</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#run-app"><span class="toc-number">2.4.</span> <span class="toc-text">run app</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-problem"><span class="toc-number">3.</span> <span class="toc-text">The problem</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Node.js project with neutrino and hmr
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">DysFunctional Programmer</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-05-04T20:47:33.000Z" itemprop="datePublished">2018-05-04</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/HMR/">HMR</a>, <a class="tag-link" href="/tags/neutrino/">neutrino</a>, <a class="tag-link" href="/tags/node/">node</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Why"><a href="#Why" class="headerlink" title="Why?"></a>Why?</h1><p>For frontend apps based on <a href="https://reactjs.org/" target="_blank" rel="noopener">React</a>/new-foo-framework-of-month, we are used to <a href="https://webpack.js.org/concepts/hot-module-replacement/" target="_blank" rel="noopener">HMR</a> its make development easier. On another hand, we still use nodaemon or manual restart for backend app. This solution work but destroy current state of the application during restart which can make debugging harder and startup of some apps is not a quick process.</p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>Luckily <a href="https://neutrino.js.org/" target="_blank" rel="noopener">neutrino</a> project provides the easy way to start <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a> project with enabled <a href="https://webpack.js.org/concepts/hot-module-replacement/" target="_blank" rel="noopener">HMR</a>, <a href="https://facebook.github.io/jest/" target="_blank" rel="noopener">Jest</a>, and <a href="https://babeljs.io/" target="_blank" rel="noopener">Babel</a> enabled by default. In this quick tutorial, I’ll show how to setup project with <a href="https://docs.docker.com/compose/" target="_blank" rel="noopener">docker-compose</a> based development environment.</p>
<h2 id="create-project"><a href="#create-project" class="headerlink" title="create project"></a>create project</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn create @neutrinojs/project nodeutrino</span><br></pre></td></tr></table></figure>
<p>Answer few questions in order to setup project</p>
<ul>
<li>select application</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">                          _          _</span><br><span class="line">      _ __    ___  _   _ | |_  _ __ (_) _ __    ___</span><br><span class="line">     | '_ \  / _ \| | | || __|| '__|| || '_ \  / _ \</span><br><span class="line">     | | | ||  __/| |_| || |_ | |   | || | | || (_) |</span><br><span class="line">     |_| |_| \___| \__,_| \__||_|   |_||_| |_| \___/</span><br><span class="line"></span><br><span class="line">Welcome to Neutrino! 👋</span><br><span class="line">To help you create your new project, I am going to ask you a few questions.</span><br><span class="line"></span><br><span class="line">? 🤔  First up, what would you like to create? (Use arrow keys)</span><br><span class="line">❯ A web or Node.js application</span><br><span class="line">  A library</span><br><span class="line">  Components</span><br></pre></td></tr></table></figure>
<ul>
<li>select <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">                          _          _</span><br><span class="line">      _ __    ___  _   _ | |_  _ __ (_) _ __    ___</span><br><span class="line">     | &apos;_ \  / _ \| | | || __|| &apos;__|| || &apos;_ \  / _ \</span><br><span class="line">     | | | ||  __/| |_| || |_ | |   | || | | || (_) |</span><br><span class="line">     |_| |_| \___| \__,_| \__||_|   |_||_| |_| \___/</span><br><span class="line"></span><br><span class="line">Welcome to Neutrino! 👋</span><br><span class="line">To help you create your new project, I am going to ask you a few questions.</span><br><span class="line"></span><br><span class="line">? 🤔  First up, what would you like to create? A web or Node.js application</span><br><span class="line">? 🤔  Next, what kind of application would you like to create?</span><br><span class="line">  React</span><br><span class="line">  Preact</span><br><span class="line">  Vue</span><br><span class="line">❯ Node.js</span><br><span class="line">  Some other web app, e.g. Angular, jQuery, or plain JS</span><br></pre></td></tr></table></figure>
<ul>
<li>select <a href="https://facebook.github.io/jest/" target="_blank" rel="noopener">Jest</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">                          _          _</span><br><span class="line">      _ __    ___  _   _ | |_  _ __ (_) _ __    ___</span><br><span class="line">     | &apos;_ \  / _ \| | | || __|| &apos;__|| || &apos;_ \  / _ \</span><br><span class="line">     | | | ||  __/| |_| || |_ | |   | || | | || (_) |</span><br><span class="line">     |_| |_| \___| \__,_| \__||_|   |_||_| |_| \___/</span><br><span class="line"></span><br><span class="line">Welcome to Neutrino! 👋</span><br><span class="line">To help you create your new project, I am going to ask you a few questions.</span><br><span class="line"></span><br><span class="line">? 🤔  First up, what would you like to create? A web or Node.js application</span><br><span class="line">? 🤔  Next, what kind of application would you like to create? Node.js</span><br><span class="line">? 🤔  Would you like to add a test runner to your project? (Use arrow keys)</span><br><span class="line">❯ Jest</span><br><span class="line">  Mocha</span><br><span class="line">  None</span><br></pre></td></tr></table></figure>
<ul>
<li>select airbnb <a href="https://eslint.org/" target="_blank" rel="noopener">eslint</a> preset</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">                          _          _</span><br><span class="line">      _ __    ___  _   _ | |_  _ __ (_) _ __    ___</span><br><span class="line">     | &apos;_ \  / _ \| | | || __|| &apos;__|| || &apos;_ \  / _ \</span><br><span class="line">     | | | ||  __/| |_| || |_ | |   | || | | || (_) |</span><br><span class="line">     |_| |_| \___| \__,_| \__||_|   |_||_| |_| \___/</span><br><span class="line"></span><br><span class="line">Welcome to Neutrino! 👋</span><br><span class="line">To help you create your new project, I am going to ask you a few questions.</span><br><span class="line"></span><br><span class="line">? 🤔  First up, what would you like to create? A web or Node.js application</span><br><span class="line">? 🤔  Next, what kind of application would you like to create? Node.js</span><br><span class="line">? 🤔  Would you like to add a test runner to your project? Jest</span><br><span class="line">? 🤔  Would you like to add linting to your project? (Use arrow keys)</span><br><span class="line">❯ Airbnb style rules</span><br><span class="line">  StandardJS rules</span><br><span class="line">  None</span><br></pre></td></tr></table></figure>
<h2 id="setup-docker"><a href="#setup-docker" class="headerlink" title="setup docker"></a>setup docker</h2><p>As startup project from host machine is acceptable as development environment should we predictable and as close as possible to production. Both of this requirements are satisfied by docker. Save this file as <code>docker-compose.yml</code>:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"2.2"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  app:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="attr">node:8</span></span><br><span class="line"><span class="attr">    volumes:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">./:$PWD</span></span><br><span class="line"><span class="attr">    working_dir:</span> <span class="string">$PWD</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"3000:3000"</span></span><br><span class="line"><span class="attr">    command:</span> <span class="string">yarn</span> <span class="string">start</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  tests:</span></span><br><span class="line"><span class="attr">    extends:</span> <span class="string">app</span></span><br><span class="line"><span class="attr">    command:</span> <span class="string">yarn</span> <span class="string">test</span></span><br></pre></td></tr></table></figure>
<h2 id="run-tests"><a href="#run-tests" class="headerlink" title="run tests"></a>run tests</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose rm --rm tests</span><br></pre></td></tr></table></figure>
<h2 id="run-app"><a href="#run-app" class="headerlink" title="run app"></a>run app</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up app</span><br></pre></td></tr></table></figure>
<h1 id="The-problem"><a href="#The-problem" class="headerlink" title="The problem"></a>The problem</h1><p>HMR work out of box but if you make some syntaxt error you will need restart aplication</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo "the bug!" &gt;&gt; src/app.js</span><br></pre></td></tr></table></figure>
<p>and you get something like:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app_1    | [HMR] Cannot apply update.</span><br><span class="line">app_1    | [HMR] Error: Module build failed: SyntaxError: Unexpected token, expected ; (6:4)</span><br><span class="line">app_1    |</span><br><span class="line">app_1    |   4 |</span><br><span class="line">app_1    |   5 | export default app;</span><br><span class="line">app_1    | &gt; 6 | the bug</span><br><span class="line">app_1    |     |     ^</span><br><span class="line">app_1    |   7 |</span><br><span class="line">app_1    |</span><br><span class="line">app_1    |     at Object../src/app.js (/home/beetleman/Projects/nodeutrino/build/0.c485d22b6ea60c2a147d.hot-update.js:8:7)</span><br><span class="line">app_1    |     at __webpack_require__ (/home/beetleman/Projects/nodeutrino/build/index.js:639:30)</span><br><span class="line">app_1    |     at fn (/home/beetleman/Projects/nodeutrino/build/index.js:49:20)</span><br><span class="line">app_1    |     at /home/beetleman/Projects/nodeutrino/build/index.js:855:108</span><br><span class="line">app_1    |     at hotApply (/home/beetleman/Projects/nodeutrino/build/index.js:542:17)</span><br><span class="line">app_1    |     at /home/beetleman/Projects/nodeutrino/build/index.js:250:21</span><br><span class="line">app_1    |     at &lt;anonymous&gt;</span><br><span class="line">app_1    | [HMR] You need to restart the application!</span><br></pre></td></tr></table></figure>
<p>It is rly anoying during development but lucky solution for this is quite simple. We need wrap our<br><code>import</code> statment in <code>try catch</code> block. To achieve this goal we create <code>HMRApp.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable */</span></span><br><span class="line"><span class="keyword">let</span> app;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  app = <span class="built_in">require</span>(<span class="string">'./app'</span>).default;</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">  <span class="built_in">console</span>.error(err);</span><br><span class="line">  app = <span class="function"><span class="params">()</span> =&gt;</span> err.message;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> app;</span><br></pre></td></tr></table></figure>
<p>and then replace <code>./app</code> with <code>./HMRApp</code> in <code>index.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> &#123; createServer &#125; <span class="keyword">from</span> <span class="string">'http'</span>;</span><br><span class="line"><span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'./HMRApp'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT || <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">createServer(<span class="function">(<span class="params">request, response</span>) =&gt;</span> response.end(app()))</span><br><span class="line">  .listen(port, () =&gt; process.stdout.write(<span class="string">`Running on :<span class="subst">$&#123;port&#125;</span>\n`</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="built_in">module</span>.hot.accept(<span class="string">'./HMRApp'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> after restarting app you should get:</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">app_1    | yarn run v1.5.1</span><br><span class="line">app_1    | $ neutrino start</span><br><span class="line">app_1    | Error: Module build failed: SyntaxError: Unexpected token, expected ; (6:4)</span><br><span class="line">app_1    |</span><br><span class="line">app_1    |   4 |</span><br><span class="line">app_1    |   5 | export default app;</span><br><span class="line">app_1    | &gt; 6 | the bug</span><br><span class="line">app_1    |     |     ^</span><br><span class="line">app_1    |   7 |</span><br><span class="line">app_1    |</span><br><span class="line">app_1    |     at Object../src/app.js (/home/beetleman/Projects/nodeutrino/build/index.js:848:7)</span><br><span class="line">app_1    |     at __webpack_require__ (/home/beetleman/Projects/nodeutrino/build/index.js:639:30)</span><br><span class="line">app_1    |     at fn (/home/beetleman/Projects/nodeutrino/build/index.js:49:20)</span><br><span class="line">app_1    |     at Object../src/HMRApp.js (/home/beetleman/Projects/nodeutrino/build/index.js:836:9)</span><br><span class="line">app_1    |     at __webpack_require__ (/home/beetleman/Projects/nodeutrino/build/index.js:639:30)</span><br><span class="line">app_1    |     at fn (/home/beetleman/Projects/nodeutrino/build/index.js:49:20)</span><br><span class="line">app_1    |     at Object../src/index.js (/home/beetleman/Projects/nodeutrino/build/index.js:859:66)</span><br><span class="line">app_1    |     at __webpack_require__ (/home/beetleman/Projects/nodeutrino/build/index.js:639:30)</span><br><span class="line">app_1    |     at fn (/home/beetleman/Projects/nodeutrino/build/index.js:49:20)</span><br><span class="line">app_1    |     at Object.0 (/home/beetleman/Projects/nodeutrino/build/index.js:876:1)</span><br><span class="line">app_1    | Running on :3000</span><br></pre></td></tr></table></figure>
<p> and now you can remove <code>the bug</code> and enjoi HMR!</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app_1    |     at __webpack_require__ (/home/beetleman/Projects/nodeutrino/build/index.js:639:30)</span><br><span class="line">app_1    |     at fn (/home/beetleman/Projects/nodeutrino/build/index.js:49:20)</span><br><span class="line">app_1    |     at Object.0 (/home/beetleman/Projects/nodeutrino/build/index.js:876:1)</span><br><span class="line">app_1    | Running on :3000</span><br><span class="line">app_1    | [HMR] Updated modules:</span><br><span class="line">app_1    | [HMR]  - ./src/app.js</span><br><span class="line">app_1    | [HMR]  - ./src/HMRApp.js</span><br><span class="line">app_1    | [HMR] Update applied.</span><br></pre></td></tr></table></figure>
<p>Of course implementation of <code>HMRApp.js</code> depends on how <code>app.js</code> is implemented bu basic idea is that if import throw exception replace if with mock of <code>app</code> and print error on <code>strerr</code>.</p>
<p>Implementation of example app is avialable in github <a href="https://github.com/beetleman/nodeutrino" target="_blank" rel="noopener">repo</a>.</p>
<p>Happy hacking ❤️!</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/beetleman">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Why"><span class="toc-number">1.</span> <span class="toc-text">Why?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Solution"><span class="toc-number">2.</span> <span class="toc-text">Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#create-project"><span class="toc-number">2.1.</span> <span class="toc-text">create project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setup-docker"><span class="toc-number">2.2.</span> <span class="toc-text">setup docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#run-tests"><span class="toc-number">2.3.</span> <span class="toc-text">run tests</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#run-app"><span class="toc-number">2.4.</span> <span class="toc-text">run app</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-problem"><span class="toc-number">3.</span> <span class="toc-text">The problem</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&text=Node.js project with neutrino and hmr"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&is_video=false&description=Node.js project with neutrino and hmr"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Node.js project with neutrino and hmr&body=Check out this article: https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&title=Node.js project with neutrino and hmr"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://beetleman.github.io/2018/05/04/node-project-with-neutrino-and-hmr/&name=Node.js project with neutrino and hmr&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Mateusz Probachta (aka beetleman)
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/beetleman">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/Fantasque_Sans_Mono/stylesheet.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-106611993-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


